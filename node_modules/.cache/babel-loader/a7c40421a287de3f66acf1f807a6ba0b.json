{"ast":null,"code":"import { put } from \"redux-saga/effects\";\nimport { setAlert, setLoading, setRedirect } from \"../Common/slice\";\nimport axios from \"../../axiosInstance\";\nimport { getMovieList, setCurrentMovie, setMovieList } from \"./slice\";\nimport { logoutUser } from \"redux/Auth/slice\";\n\nconst getRequestHeader = () => {\n  const token = localStorage.getItem(\"Mtoken\");\n  return {\n    authorization: `Bearer ${token}`\n  };\n};\n\nexport function* fetchMovieListSaga(action) {\n  yield put(setLoading(true));\n\n  try {\n    const response = yield axios.get(\"http://127.0.0.1:8000/movies\", {\n      headers: getRequestHeader()\n    });\n    yield put(setMovieList(response.data));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield put(logoutUser());\n      yield put(setAlert({\n        state: true,\n        text: \"Please login again\",\n        color: \"danger\"\n      }));\n    } else {\n      yield put(setAlert({\n        state: true,\n        text: \"Something Wrong!\",\n        color: \"danger\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieListSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n  }\n}\nexport function* fetchMovieSaga(action) {\n  yield put(setLoading(true));\n\n  try {\n    const response = yield axios.get(\"http://127.0.0.1:8000/movies\", {\n      params: {\n        id: action.payload\n      },\n      headers: getRequestHeader()\n    });\n    yield put(setCurrentMovie(response.data[0]));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield put(logoutUser());\n      yield put(setAlert({\n        state: true,\n        text: \"Please login again\",\n        color: \"danger\"\n      }));\n    } else {\n      yield put(setAlert({\n        state: true,\n        text: \"Something Wrong!\",\n        color: \"danger\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n  }\n}\nexport function* deleteMovieSaga(action) {\n  yield put(setLoading(true));\n\n  try {\n    const response = yield axios.delete(`http://127.0.0.1:8000/movies/${action.payload}`, {\n      headers: getRequestHeader()\n    });\n    yield put(getMovieList());\n    yield put(setRedirect({\n      state: true,\n      url: \"/\"\n    }));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield put(logoutUser());\n      yield put(setAlert({\n        state: true,\n        text: \"Please login again\",\n        color: \"danger\"\n      }));\n    } else {\n      yield put(setAlert({\n        state: true,\n        text: \"Something Wrong!\",\n        color: \"danger\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n  }\n}\nexport function* editMovieSaga(action) {\n  yield put(setLoading(true));\n\n  try {\n    const data = {\n      name: action.payload.name,\n      description: action.payload.description\n    };\n    const response = yield axios.patch(`http://127.0.0.1:8000/movies/${action.payload.id}`, data, {\n      headers: getRequestHeader()\n    });\n    yield put(getMovieList());\n    yield put(setCurrentMovie({\n      creator: \"\",\n      id: null,\n      name: \"\",\n      description: \"\"\n    }));\n    yield put(setRedirect({\n      state: true,\n      url: \"/\"\n    }));\n    yield put(setAlert({\n      state: true,\n      text: \"Movie edited successfuly\",\n      color: \"success\"\n    }));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield put(logoutUser());\n      yield put(setAlert({\n        state: true,\n        text: \"Please login again\",\n        color: \"danger\"\n      }));\n    } else {\n      yield put(setAlert({\n        state: true,\n        text: \"Something Wrong!\",\n        color: \"danger\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n  }\n}\nexport function* addMovieSaga(action) {\n  yield put(setLoading(true));\n\n  try {\n    const data = {\n      name: action.payload.name,\n      description: action.payload.description,\n      creator: action.payload.creator\n    };\n    const response = yield axios.post(`http://127.0.0.1:8000/movies`, data, {\n      headers: getRequestHeader()\n    });\n    yield put(getMovieList());\n    yield put(setRedirect({\n      state: true,\n      url: \"/\"\n    }));\n    yield put(setAlert({\n      state: true,\n      text: \"Movie added successfuly\",\n      color: \"success\"\n    }));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield put(logoutUser());\n      yield put(setAlert({\n        state: true,\n        text: \"Please login again\",\n        color: \"danger\"\n      }));\n    } else {\n      yield put(setAlert({\n        state: true,\n        text: \"Something Wrong!\",\n        color: \"danger\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n  }\n}","map":{"version":3,"names":["put","setAlert","setLoading","setRedirect","axios","getMovieList","setCurrentMovie","setMovieList","logoutUser","getRequestHeader","token","localStorage","getItem","authorization","fetchMovieListSaga","action","response","get","headers","data","err","status","state","text","color","console","error","fetchMovieSaga","params","id","payload","deleteMovieSaga","delete","url","editMovieSaga","name","description","patch","creator","addMovieSaga","post"],"sources":["/home/hanie/Documents/demoProjects/movie-suggest/src/redux/Movie/sagas.ts"],"sourcesContent":["import { put } from \"redux-saga/effects\";\r\n\r\nimport { setAlert, setLoading, setRedirect } from \"../Common/slice\";\r\n\r\nimport axios from \"../../axiosInstance\";\r\nimport { PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { getMovieList, setCurrentMovie, setMovieList } from \"./slice\";\r\nimport { IMovie } from \"types/types\";\r\nimport { logoutUser } from \"redux/Auth/slice\";\r\n\r\nconst getRequestHeader = () => {\r\n  const token = localStorage.getItem(\"Mtoken\");\r\n  return { authorization: `Bearer ${token}` };\r\n};\r\n\r\nexport function* fetchMovieListSaga(\r\n  action: PayloadAction<number | string>\r\n): Generator {\r\n  yield put(setLoading(true));\r\n  try {\r\n    const response: any = yield axios.get(\"http://127.0.0.1:8000/movies\", {\r\n      headers: getRequestHeader(),\r\n    });\r\n    yield put(setMovieList(response.data));\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield put(logoutUser());\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Please login again\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    } else {\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Something Wrong!\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    }\r\n    console.error(\"sagaERR fetchMovieListSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n  }\r\n}\r\n\r\nexport function* fetchMovieSaga(\r\n  action: PayloadAction<number | string>\r\n): Generator {\r\n  yield put(setLoading(true));\r\n  try {\r\n    const response: any = yield axios.get(\"http://127.0.0.1:8000/movies\", {\r\n      params: {\r\n        id: action.payload,\r\n      },\r\n      headers: getRequestHeader(),\r\n    });\r\n\r\n    yield put(setCurrentMovie(response.data[0]));\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield put(logoutUser());\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Please login again\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    } else {\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Something Wrong!\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    }\r\n    console.error(\"sagaERR fetchMovieSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n  }\r\n}\r\n\r\nexport function* deleteMovieSaga(\r\n  action: PayloadAction<number | string>\r\n): Generator {\r\n  yield put(setLoading(true));\r\n  try {\r\n    const response: any = yield axios.delete(\r\n      `http://127.0.0.1:8000/movies/${action.payload}`,\r\n      {\r\n        headers: getRequestHeader(),\r\n      }\r\n    );\r\n    yield put(getMovieList());\r\n    yield put(setRedirect({ state: true, url: \"/\" }));\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield put(logoutUser());\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Please login again\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    } else {\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Something Wrong!\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    }\r\n    console.error(\"sagaERR fetchMovieSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n  }\r\n}\r\n\r\nexport function* editMovieSaga(action: PayloadAction<IMovie>): Generator {\r\n  yield put(setLoading(true));\r\n  try {\r\n    const data = {\r\n      name: action.payload.name,\r\n      description: action.payload.description,\r\n    };\r\n    const response: any = yield axios.patch(\r\n      `http://127.0.0.1:8000/movies/${action.payload.id}`,\r\n      data,\r\n      {\r\n        headers: getRequestHeader(),\r\n      }\r\n    );\r\n\r\n    yield put(getMovieList());\r\n    yield put(\r\n      setCurrentMovie({ creator: \"\", id: null, name: \"\", description: \"\" })\r\n    );\r\n    yield put(setRedirect({ state: true, url: \"/\" }));\r\n    yield put(\r\n      setAlert({\r\n        state: true,\r\n        text: \"Movie edited successfuly\",\r\n        color: \"success\",\r\n      })\r\n    );\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield put(logoutUser());\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Please login again\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    } else {\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Something Wrong!\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    }\r\n    console.error(\"sagaERR fetchMovieSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n  }\r\n}\r\n\r\nexport function* addMovieSaga(action: PayloadAction<IMovie>): Generator {\r\n  yield put(setLoading(true));\r\n  try {\r\n    const data = {\r\n      name: action.payload.name,\r\n      description: action.payload.description,\r\n      creator: action.payload.creator,\r\n    };\r\n    const response: any = yield axios.post(\r\n      `http://127.0.0.1:8000/movies`,\r\n      data,\r\n      {\r\n        headers: getRequestHeader(),\r\n      }\r\n    );\r\n\r\n    yield put(getMovieList());\r\n    yield put(setRedirect({ state: true, url: \"/\" }));\r\n    yield put(\r\n      setAlert({\r\n        state: true,\r\n        text: \"Movie added successfuly\",\r\n        color: \"success\",\r\n      })\r\n    );\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield put(logoutUser());\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Please login again\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    } else {\r\n      yield put(\r\n        setAlert({\r\n          state: true,\r\n          text: \"Something Wrong!\",\r\n          color: \"danger\",\r\n        })\r\n      );\r\n    }\r\n    console.error(\"sagaERR fetchMovieSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}