{"ast":null,"code":"import { put } from \"redux-saga/effects\";\nimport { setLoading, setRedirect } from \"../Common/slice\";\nimport axios from \"../../axiosInstance\";\nimport { setMovieList } from \"./slice\";\n\nconst getRequestHeader = () => {\n  const token = localStorage.getItem(\"Mtoken\");\n  return {\n    authorization: `Bearer ${token}`\n  };\n};\n\nexport function* fetchMovieListSaga(action) {\n  yield put(setLoading(true));\n\n  try {\n    const response = yield axios.get(\"http://127.0.0.1:8000/movies\", {\n      headers: getRequestHeader()\n    });\n    yield put(setMovieList(response.data));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield localStorage.removeItem(\"Mtoken\");\n      yield put(setRedirect({\n        state: true,\n        url: \"/login\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieListSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n  }\n}\nexport function* fetchMovieSaga(action) {\n  yield put(setLoading(true));\n  console.log(\"loading saga\", true);\n\n  try {\n    const response = yield axios.get(\"http://127.0.0.1:8000/movies\", {\n      params: {\n        id: action.payload\n      },\n      headers: getRequestHeader()\n    });\n    console.log(\"after Res\"); // yield put(setMovieList(response.data));\n  } catch (err) {\n    if (err.response.status === 401) {\n      yield localStorage.removeItem(\"Mtoken\");\n      yield put(setRedirect({\n        state: true,\n        url: \"/login\"\n      }));\n    }\n\n    console.error(\"sagaERR fetchMovieSaga\", err);\n  } finally {\n    yield put(setLoading(false));\n    console.log(\"loading saga\", fasle);\n  }\n}","map":{"version":3,"names":["put","setLoading","setRedirect","axios","setMovieList","getRequestHeader","token","localStorage","getItem","authorization","fetchMovieListSaga","action","response","get","headers","data","err","status","removeItem","state","url","console","error","fetchMovieSaga","log","params","id","payload","fasle"],"sources":["/home/hanie/Documents/demoProjects/movie-suggest/src/redux/Movie/sagas.ts"],"sourcesContent":["import { put } from \"redux-saga/effects\";\r\n\r\nimport { setLoading, setRedirect } from \"../Common/slice\";\r\n\r\nimport axios from \"../../axiosInstance\";\r\nimport { PayloadAction } from \"@reduxjs/toolkit\";\r\nimport { setMovieList } from \"./slice\";\r\n\r\nconst getRequestHeader = () => {\r\n  const token = localStorage.getItem(\"Mtoken\");\r\n  return { authorization: `Bearer ${token}` };\r\n};\r\n\r\nexport function* fetchMovieListSaga(\r\n  action: PayloadAction<number | string>\r\n): Generator {\r\n  yield put(setLoading(true));\r\n  try {\r\n    const response: any = yield axios.get(\"http://127.0.0.1:8000/movies\", {\r\n      headers: getRequestHeader(),\r\n    });\r\n    yield put(setMovieList(response.data));\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield localStorage.removeItem(\"Mtoken\");\r\n      yield put(setRedirect({ state: true, url: \"/login\" }));\r\n    }\r\n    console.error(\"sagaERR fetchMovieListSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n  }\r\n}\r\n\r\nexport function* fetchMovieSaga(\r\n  action: PayloadAction<number | string>\r\n): Generator {\r\n  yield put(setLoading(true));\r\n  console.log(\"loading saga\", true);\r\n  try {\r\n    const response: any = yield axios.get(\"http://127.0.0.1:8000/movies\", {\r\n      params: {\r\n        id: action.payload,\r\n      },\r\n      headers: getRequestHeader(),\r\n    });\r\n    console.log(\"after Res\");\r\n\r\n    // yield put(setMovieList(response.data));\r\n  } catch (err: any) {\r\n    if (err.response.status === 401) {\r\n      yield localStorage.removeItem(\"Mtoken\");\r\n      yield put(setRedirect({ state: true, url: \"/login\" }));\r\n    }\r\n    console.error(\"sagaERR fetchMovieSaga\", err);\r\n  } finally {\r\n    yield put(setLoading(false));\r\n    console.log(\"loading saga\", fasle);\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAASA,GAAT,QAAoB,oBAApB;AAEA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,iBAAxC;AAEA,OAAOC,KAAP,MAAkB,qBAAlB;AAEA,SAASC,YAAT,QAA6B,SAA7B;;AAEA,MAAMC,gBAAgB,GAAG,MAAM;EAC7B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAd;EACA,OAAO;IAAEC,aAAa,EAAG,UAASH,KAAM;EAAjC,CAAP;AACD,CAHD;;AAKA,OAAO,UAAUI,kBAAV,CACLC,MADK,EAEM;EACX,MAAMX,GAAG,CAACC,UAAU,CAAC,IAAD,CAAX,CAAT;;EACA,IAAI;IACF,MAAMW,QAAa,GAAG,MAAMT,KAAK,CAACU,GAAN,CAAU,8BAAV,EAA0C;MACpEC,OAAO,EAAET,gBAAgB;IAD2C,CAA1C,CAA5B;IAGA,MAAML,GAAG,CAACI,YAAY,CAACQ,QAAQ,CAACG,IAAV,CAAb,CAAT;EACD,CALD,CAKE,OAAOC,GAAP,EAAiB;IACjB,IAAIA,GAAG,CAACJ,QAAJ,CAAaK,MAAb,KAAwB,GAA5B,EAAiC;MAC/B,MAAMV,YAAY,CAACW,UAAb,CAAwB,QAAxB,CAAN;MACA,MAAMlB,GAAG,CAACE,WAAW,CAAC;QAAEiB,KAAK,EAAE,IAAT;QAAeC,GAAG,EAAE;MAApB,CAAD,CAAZ,CAAT;IACD;;IACDC,OAAO,CAACC,KAAR,CAAc,4BAAd,EAA4CN,GAA5C;EACD,CAXD,SAWU;IACR,MAAMhB,GAAG,CAACC,UAAU,CAAC,KAAD,CAAX,CAAT;EACD;AACF;AAED,OAAO,UAAUsB,cAAV,CACLZ,MADK,EAEM;EACX,MAAMX,GAAG,CAACC,UAAU,CAAC,IAAD,CAAX,CAAT;EACAoB,OAAO,CAACG,GAAR,CAAY,cAAZ,EAA4B,IAA5B;;EACA,IAAI;IACF,MAAMZ,QAAa,GAAG,MAAMT,KAAK,CAACU,GAAN,CAAU,8BAAV,EAA0C;MACpEY,MAAM,EAAE;QACNC,EAAE,EAAEf,MAAM,CAACgB;MADL,CAD4D;MAIpEb,OAAO,EAAET,gBAAgB;IAJ2C,CAA1C,CAA5B;IAMAgB,OAAO,CAACG,GAAR,CAAY,WAAZ,EAPE,CASF;EACD,CAVD,CAUE,OAAOR,GAAP,EAAiB;IACjB,IAAIA,GAAG,CAACJ,QAAJ,CAAaK,MAAb,KAAwB,GAA5B,EAAiC;MAC/B,MAAMV,YAAY,CAACW,UAAb,CAAwB,QAAxB,CAAN;MACA,MAAMlB,GAAG,CAACE,WAAW,CAAC;QAAEiB,KAAK,EAAE,IAAT;QAAeC,GAAG,EAAE;MAApB,CAAD,CAAZ,CAAT;IACD;;IACDC,OAAO,CAACC,KAAR,CAAc,wBAAd,EAAwCN,GAAxC;EACD,CAhBD,SAgBU;IACR,MAAMhB,GAAG,CAACC,UAAU,CAAC,KAAD,CAAX,CAAT;IACAoB,OAAO,CAACG,GAAR,CAAY,cAAZ,EAA4BI,KAA5B;EACD;AACF"},"metadata":{},"sourceType":"module"}